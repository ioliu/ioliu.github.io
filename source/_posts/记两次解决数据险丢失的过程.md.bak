---
title: 记两次解决险丢数据的过程
date: 2018-07-22 14:15:00
tags: 折(作)腾(死)日记
categories: 折(作)腾(死)日记
---
-----------------------
<!--more-->
昨天心血来潮想装个Linux，和win10组双系统，刻完盘后进去安装界面，提示Unable to find a medium containing a live file system。经过各种查资料，得知是刻录工具的问题，换了配套的刻录工具之后进去安装盘卡在徽标界面
进PE里格分区的时候，误操作不小心把引导分区給格了，这下win10也进不去了，于是在PE里查找各种可用的工具来恢复引导，手动新建、使用bootice创建、用diskgenius都没效果，依然进不去，后来打开dism++发现它竟然能识别到win10，心想肯定可以帮我恢复，果然找到了修复引导的选项。
当时格式化的分区是位于机械硬盘上的，因为我的win10装在固态硬盘上，所以错误的认为引导分区应该是固态上那一块，就把机械硬盘的esp分区给格式化了。
修复很简单，直接把两块盘上的esp分区都格式化，然后向固态的esp分区写入引导，在BIOS里更改第一启动为固态硬盘，成功回到原系统
![微PE网络版](https://wx4.sinaimg.cn/large/006btIwUly1ftinq1mu0qj31hc0u0wzf.jpg)
![微PE网络版](https://wx1.sinaimg.cn/large/006btIwUly1ftinq11k8bj31hc0u07mg.jpg)
![微PE网络版](https://wx4.sinaimg.cn/large/006btIwUly1ftinq23lvvj31hc0u0qlb.jpg)
回到原系统后尝试使用安装器再次安装，提示硬盘必须要有MBR分区，于是想直接把机械硬盘无损转换成MBR分区表，结果竟然忘了之前在机械硬盘里有创建符号链接，因为不想太多占用固态硬盘的空间，所以把win10的用户目录链接到了机械硬盘的H:\，刚点完转换，win10就崩了，再打开分区助手，整个机械盘已经变成了未分配状态，所有数据都不见了
按照以前的经验，在这么短的时间内，应该是无法把这么多数据都擦除的，数据肯定还保存在磁盘上，只不过没表现出来，慌忙之下又回到PE中，打开diskgenius，选定硬盘1，搜索丢失的分区，搜索范围整个硬盘，结果搜到了五个分区，然后保存分区表，接近1TB的数据就这样又回到了原位。
开机进win10，仍然不能用，提示无法加载用户配置文件，猜测是因为恢复分区后盘符改变，以前创建的符号链接对应的盘符下没有目标文件
尝试安全模式等办法均没有解决，想把以前在H:创建的符号文件复制回原盘，结果原盘剩的空间不够了，于是又回到PE下，既然dism++可以检测到win10，那么肯定就能修改win10的一些设置，用dism++开启了win10的Administrator账户权限，开机用administrator进win10，删掉win10的Users目录下的Mr.Liu用户文件夹，然后cmd创建符号链接`mklink /J "C:\Users\Mr.liu" "H:\Mr.liu"` ，切换用户，用Mr.liu登录，输入密码，成功回到原系统原账户，桌面快捷方式、注册表、启动项等等都还是之前正常时的样子
两场虚惊，看来还是diskgenius的那句话最靠谱：数据无价，谨慎操作
以后再折腾硬盘相关的东西时一定要谨慎对待，而且PE的作用特别大，遇到问题先在PE中找找看有没有提供相关的功能，尽量最大限度的保存之前的数据资料
![微PE网络版](https://wx1.sinaimg.cn/large/006btIwUly1ftinq06jp0j31hc0u07wi.jpg)
